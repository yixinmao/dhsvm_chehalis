#!/usr/local/bin/python

######### compare results from two runs (same running time period) ###########


from mpl_toolkits.basemap import Basemap, cm
import numpy as np
import matplotlib as mpl
import matplotlib.pyplot as plt
import argparse
import pdb
import datetime as dt


################# user defined ################
result_path_1 = '/usr1/ymao/dhsvm_chehalis/result_analyis/results_v2.1_nonswap'
result_path_2 = '/usr1/ymao/dhsvm_chehalis/result_analyis/results_v3.1.2'
label1 = 'v2.1'
label2 = 'v3.1.2'
output_path = '/usr1/ymao/dhsvm_chehalis/result_analyis/output/compare_v2.1_v3.1.2'
start_time = dt.datetime(year=2013, month=4, day=3, hour=9)
end_time = dt.datetime(year=2013, month=4, day=6, hour=9)
dtime = 3  # hours

duration = end_time - start_time
ntime = (duration.days*24 + duration.seconds//3600)/dtime+1
dates = []
for i in range(ntime):
	dates.append(start_time + dt.timedelta(hours=i*dtime))

################## Aggregated.Values ################
#f = open('%s/Aggregated.Values' %result_path_1, 'r')
#titles1 = f.readline().rstrip("\n").split()
#f.close()
#f = open('%s/Aggregated.Values' %result_path_2, 'r')
#titles2 = f.readline().rstrip("\n").split()
#f.close()
#
#agg1 = np.loadtxt('%s/Aggregated.Values' %result_path_1, skiprows=1, usecols=range(1,len(titles1)))
#agg2 = np.loadtxt('%s/Aggregated.Values' %result_path_2, skiprows=1, usecols=range(1,len(titles2)))
#
#print "Titles in file 1 not existing in file 2:"
#for i in range(len(titles1)-1):  # for every column in file1, find the column with the same title in file 2 -> plot; i in terms of agg
#	if titles1[i+1]=="Precip":   # in v2.1, Precip; in v3.1.2, Precip(m)
#		j = titles2.index("Precip(m)") - 1
#	elif titles1[i+1]=="EvapTot":  
#		j = titles2.index("TotEvap") - 1
#	elif titles1[i+1]=="SoilMoist0":  
#		j = titles2.index("SoilMoist1") - 1
#	elif titles1[i+1]=="SoilMoist1":  
#		j = titles2.index("SoilMoist2") - 1
#	elif titles1[i+1]=="SoilMoist2":  
#		j = titles2.index("SoilMoist3") - 1
#	elif titles1[i+1]=="Perc0":  
#		j = titles2.index("Perc1") - 1
#	elif titles1[i+1]=="Perc1":  
#		j = titles2.index("Perc2") - 1
#	elif titles1[i+1]=="Perc2":  
#		j = titles2.index("Perc3") - 1
#	elif titles1[i+1]=="OverSnow":  
#		j = titles2.index("SnowCover") - 1
#	elif (titles1[i+1] in titles2) == False:   # if this title in file1 does NOT exist in file2
#		print titles1[i+1]
#		continue
#	else:  # if this title in file 1 exists in file 1
#		j = titles2.index(titles1[i+1]) - 1
#	fig = plt.figure()
#	ax = plt.axes()
#	ax.plot_date(dates, agg1[0:np.shape(agg1)[0]-1,i], 'b-', label=label1)
#	ax.plot_date(dates, agg2[0:np.shape(agg2)[0]-1,j], 'r-', label=label2)
#	plt.legend()
#	plt.title(titles2[j+1])
#	fig.savefig('%s/Aggregated.Values.%s.png' %(output_path, titles2[j+1]), format='png')
#
#print "\nTitles in file 2 not existing in file 1:"
#for i in range(len(titles2)-1): 
#	if titles2[i+1]=="Precip(m)":   
#		continue
#		j = titles2.index("TotEvap") - 1
#	elif (titles2[i+1] in titles1) == False:  
#		print titles2[i+1]
#		continue


################## Mass.Balance ################
#titles = ['Total runoff', 'Total amount of water in the canopy', 'Total amount of water in the soil', 'Total amount of SWE', 'Total amount of sat. subsurface flow', 'Total amount of water intercepted by channels', 'Total amount of water intercepted by roads', 'Total water returned by culverts to the land surface', 'Total amount of ET', 'Total amount of precipitation', 'Total sublimation from snow on the ground', 'Total sublimation from snow in the canopy', 'Total water during the previous time step', 'Total flow from culverts to the channel', 'Total surface flow to the channel', 'Total mass balance error for the current time step'] 
#agg1 = np.loadtxt('%s/Mass.Balance' %result_path_1, skiprows=0, usecols=range(1,17))
#agg2 = np.loadtxt('%s/Mass.Balance' %result_path_2, skiprows=0, usecols=range(1,17))
#
#for i in range(16):
#	fig = plt.figure()
#	ax = plt.axes()
#	ax.plot_date(dates, agg1[:,i], 'b-', label=label1)
#	ax.plot_date(dates, agg2[:,i], 'r-', label=label2)
#	plt.legend()
#	plt.title(titles[i])
#	fig.savefig('%s/Mass.Balance.%d.png' %(output_path, i+1), format='png')

################## Mass.Balance ################
#f = open('%s/Streamflow.Only' %result_path_1, 'r')
#titles = f.readline().rstrip("\n").split()  # date; each gague
#agg1 = np.loadtxt('%s/Streamflow.Only' %result_path_1, skiprows=2, usecols=range(1,len(titles)))
#agg2 = np.loadtxt('%s/Streamflow.Only' %result_path_2, skiprows=2, usecols=range(1,len(titles)))
#
#for i in range(len(titles)-1):
#	fig = plt.figure()
#	ax = plt.axes()
#	ax.plot_date(dates[1:ntime], agg1[:,i], 'b-', label=label1)
#	ax.plot_date(dates[1:ntime], agg2[:,i], 'r-', label=label2)
#	plt.legend()
#	plt.title(titles[i+1])
#	fig.savefig('%s/Streamflow.Only.%s.png' %(output_path, titles[i+1]), format='png')


#plt.show()



